# 8 盒模型
CSS盒模型描述了由文档树的元素生成盒根据视觉格式化模型布局的矩形盒。
## 8.1 盒的尺寸
每个盒有一个内容区域（例如，文本，图片，等等）和可选的围绕的内边距，边框，和外边距区域；每个区域的大小由定义在下方的属性指定。下面的图示展示了这些区域如何联系和适用于外边距，边框，和内边距的术语。

外边距，边框，和内边距可以被分解为上，右，下，和左段（例如，在图示中，`LM`指左外边距，`RP`指右内边距，`TB`指上边框，等等）。

这四个区域（内容，内边距，边框，和外边距）中的每个的边界被称为`edge`，所以每个盒有四个边缘：

内容边缘或内边缘
内容边缘围绕着由盒的宽高给定的矩形，经常依赖于元素的渲染内容。四个内容边缘定义了盒的内容盒。

内边距边缘
内边距边缘围绕着盒的内边距。如果内边距的宽度为0，那么内边距边缘等同于内容边缘。四个内边距边缘定义了盒的内边距盒。

边框边缘
边框边缘围绕着盒的边框。如果边框的宽度为0，那么边框边缘等同于内边距边缘。四个边框边缘定义了盒的边框盒。

外边距边缘或外边缘
外边距边缘围绕着盒的外边距。如果外边距的宽度为0，那么外边距边缘等同于边框边缘。四个外边距边缘定义了盒的外边距盒。

每个边缘可能被分解为上，右，下，盒左边缘。

盒的内容区域的尺寸——内容宽度盒内容高度——依赖几个因素：元素是否生成了有宽高属性的盒。盒是否包含文本或其他盒，盒是否是表格，等等。

盒的内容，内边距，和边框区域的背景样式由生成的元素的`background`属性指定。外边距背景总是透明的。
## 8.2 外边距，内边距，边框的例子
[...]

注意：
- 每个LI盒的内容宽度由上而下计算；每个LI盒的包含块由UL元素创建。
- 每个LI盒的外边距盒的高度依赖其内容高度，加上上下内边距，边框，和外边距。注意LI盒的垂直外边距会合并。
- LI盒的右内边距已设置为零宽（`padding`属性）。在第二个图示中效果是明显的。
- LI盒的外边距是透明的——外边距总是透明——所以UL的内边距盒内容区域的背景色（黄色）穿透了它们。
- 第二个LI元素指定了虚线边框（`border-style`属性）。
## 8.3 外边距属性：`margin-top`，`margin-right`，`margin-bottom`，`margin-left`，和`margin`
外边距属性指定了盒的外边距区域的宽度。`margin`简写属性设置了全部四个边的外边距而其他外边距属性只设置各自的边。这些属性应用于所有元素，但是垂直外边距在非替换内联元素上不会有任何效果。

在涉及到`<margin-width>`值类型中定义的属性，可能取下面的值之一：

`<length>`
指定一个固定宽度。
`<percentage>`
百分数根据生成的盒的包含块的宽度来计算。注意对于`margin-top`和`margin-bottom`也是如此计算。如果包含块的宽度依赖于该元素，那么产生的布局在CSS2.2中未定义。
`auto`
见计算宽度和外边距的行为。

外边距属性的负值是允许的，但是可能有实现细节的限制。

[...]

如果只有一个分量值，则应用到全部边。如果有两个值，则上和下外边距设置为第一个值且右和左外边距设置为第二个。如果有三个值，上设置为第一个值，左和右设置为第二个，且下设置为第三个。如果有四个值，则分别应用到上，右，下，左。

[...]
### 8.3.1 合并外边距
在CSS中，两个或更多的盒（可能会或可能不会是兄弟）可以组合形成一个单独的外边距。这样组合外边距被称为合并，且产生的组合外边距被称为合并外边距。

相邻的垂直外边距合并，除了：

- 根元素的盒的外边距不合并。
- 如果有间隙的元素上和下外边距相邻，它的外边距和相邻接着的兄弟的外边距合并但不与父块的下外边距合并。
- 如果非零被计算的`min-height`和`auto`被计算的`height`的盒的上外边距与其最后的流内孩子的下外边距合并，那么孩子的下外边距不与父亲的下外边距合并。

水平外边距从来不合并。

两个外边距是相邻的当且仅当：

- 都属于参与到同一个块格式化上下文的流内块级盒
- 没有行盒，没有间隙，没有内边距和没有边框隔开它们（注意零高行盒被忽略以这种目的。）
- 都属于垂直相邻的盒的边缘，即，如下各对之一：
   - 盒的上外边距和其第一个流内孩子的上外边距
   - 盒的下外边距盒其接着的流内兄弟的上外边距
   - 最后的流内孩子的下外边距盒其父亲的下外边距如果该父亲有`auto`被计算的高
   - 没有创建新的块格式化上下文且零被计算的`min-height`，零或`auto`被计算的高，和没有流内孩子的盒的上和下外边距。

合并的外边距被认为盒另外的外边距相邻如果其任何外边距分量和那个外边距相邻。

注意相邻的外边距可以由非相关的兄弟或祖先元素生成。

注意上面的规则意味着：

- 浮动盒和任意其他盒之间的外边距不会合并（甚至不在浮动和其流内孩子之间）。
- 创建新的块格式化上下文（如浮动和`overflow`不为`visible`的元素）的元素的外边距不与其流内孩子合并。
- 绝对定位的盒的外边距不与合并（甚至不与其流内孩子）。
- 内联块盒的外边距不合并（甚至不与其流内孩子）。
- 流内块级元素的下外边距总是与其后的流内块级兄弟的上外边距合并，除非兄弟有间隙。
- 流内块元素的上外边距与其第一个流内块级孩子的上外边距合并如果该元素没有上边框，没有上内边距，且此孩子没有间隙。
- 流内`height`为`auto`的块盒的下外边距与其最后的流内块级孩子的下外边距合并，如果：
   - 盒没有下内边距，且
   - 盒没有下边框，且
   - 孩子的下外边距既不与有间隙的上外边距合并，也（如果盒的min-height非零）不和盒的上外边距合并。
- 盒自身的外边距合并如果`min-height`属性为零，且它既没有上或下边框也没有上或下内边距，且它的`height`要么是0要么是`auto`，且它不包含行盒，且它的所有流内孩子的外边距合并。

当两个或更多外边距合并，产生的外边距的宽度等于所合并的外边距的宽度的最大者。在外边距为负的情况下，负的相邻的外边距的绝对值的最大者从正的相邻外边距的最大者扣除。如果没有正的外边距，相邻外边距的绝对值的最大者从零扣除。

如果盒的上和下外边距相邻，那么外边距可能被彻底合并。这种情况下，元素的位置依赖于其与外边距被合并的其他元素的关系。

- 如果元素的外边距被合并和其父亲的上外边距，盒的上边框边缘被定义为和父亲的相同。
- 否则，要么元素的父亲不参与到外边距合并，要么父亲只有下外边距涉及。元素的上边框边缘的位置和其有非零下边框的正常显示相同。

注意已经彻底合并的元素的位置不会影响外边距被合并的其他元素的位置；上边框边缘的位置只是为这些元素的后代的布局需要。
## 8.4 内边距属性：`padding-top`，`padding-right`，`padding-bottom`，`padding-left`，和`padding`
内边距属性指定盒的内边距区域的宽度。`padding`简写属性给四个边都设置了内边距而其他内边距属性只设置相应的边。

章节中定义的这个属性参考了<padding-width>值类型，可能取得如下值：

`<length>`
指定了固定的宽度
`<percentage>`
百分数计算根据生成的盒的包含块的宽度，即使对于`padding-top`和`padding-bottom`。如果包含块的宽度依赖于这个元素，那么产生的布局在CSS2.2中未定义。

不像外边距属性，内边距的值不能为负数。如外边距，内边距属性的百分数值参考生成的盒的包含块的宽度。

[...]

`padding`属性是设置`padding-top`，`padding-right`，`padding-bottom`，和`padding-left`的简写属性在样式表中相同的地方。

如果只有一个分量值，它应用到所有的边。如果有两个值，上和下内边距被设置为第一个值而右和左内边距被设置为第二个。如果有三个值，上被设置为第一个值，左和右被设置为第二个，而下被设置为第三个。如果有四个值，则相应的应用到上，右，下，和左。

内边距区域的表面颜色或图片被指定通过`background`属性。
## 8.5 边框属性
边框属性指定了盒的宽度，颜色，和边框区域的样式。这些属性应用到所有元素。

注意尤其对于HTML，用户代理可能为某些用户界面元素（例如，按钮，菜单，等等）渲染边框不同于“普通”元素。
### 8.5.1 边框宽度：`border-top-width`，`border-top-width`，`border-bottom-width`，`border-left-width`，和`border-width`
边框宽度属性指定了边框区域的宽度。章节中定义这个属性参考了<border-width>值类型，可能取得如下值：

`thin`
窄边框。
`medium`
中等边框
`thick`
厚边框
`<length>`
边框的厚度有明确的值。明确的边框宽度不能为负数。

前三个值的解释依赖于用户代理。如下的关系必须遵守，然而：

`thin` <= `medium` <= `thick`

此外，这些宽度在文档中必须始终一致。

[...]
### 8.5.2 边框颜色：`border-top-color`，`border-right-color`，`border-bottom-color`，`border-left-color`，和`border-color`
`border-color`属性设置四条边的颜色。值有如下含义：

`<color>`
指定颜色值
`transparent`
边框是透明的（尽管它可能有宽度）

`border-color`属性可以有一到四个分量值，且值被设置在不同的边上的`border-width`。

如果元素的边框颜色没有以边框属性指定，用户代理必须使用元素的`color`属性的值作为边框颜色的计算值。
### 8.5.3 边框样式：`border-top-style`，`border-right-style`，`border-bottom-style`，`border-left-style`，和`border-style`
边框样式属性指定了盒的边框的线样式（实线，双线，虚线，等等）。章节中定义的这个属性才考<border-style>值类型，可能取得如下值：

`none`
无边框；边框宽度计算为零。
`hidden`
和`none`相同，except in terms of border conflict resolution for table elements.
`dotted`
边框是一系列点。
`dashed`
边框是一系列短线段。
`solid`
边框是单个线段。
`double`
边框是两条实线。两条线之和和它们之间的空间等于`border-width`的值。
`groove`
边框看起来像雕刻在画布里。
`ridge`
与`groove`相反：边框看起来从画布出来。
`inset`
边框使盒看起来嵌入在画布中。
`outset`
与`inset`相反：边框使盒看起来从画布出来。

所有的边框画在盒的背景上。边框为`groove`，`ridge`，`inset`，和`outset`的颜色依赖于元素的边框颜色属性，但是用户代理可能选择其自身的算法来计算实际使用的颜色。比如，如果`border-color`的值为`silver`，那么用户代理可能使用从白到暗灰的渐变颜色来表明一个倾斜的边框。

[...]

`border-style`属性设置四条边的样式。它可以有一到四个分量值，且这些值设置不同边的`border-width`上。

[...]

因为边框样式的初始值使`none`，边框会不可见的除非边框样式被设置。
### 8.5.4 边框的简写属性：`border-top`，`border-right`，`border-bottom`，`border-left`，和`border`
[...]
## 8.6 双向上下文中内联元素的盒模型
对于每个行盒，用户代理必须为每个元素生成行盒并且渲染外边距，边框，和内边距在视觉顺序上（非逻辑顺序）。

当元素的`direction`属性是`ltr`，元素所在的第一个行盒的最左边生成的盒有左外边距和左内边距，并且元素所在的第一个行盒的最右边生成的盒有右内边距，右边框盒有外边距。

当元素的`direction`属性是`rtl`，元素所在的第一个行盒的最右边生成的盒右右内边距，右边框盒右外边距，并且元素所在的第一个行盒的最左边生成的盒有左外边距，左边框盒左内边距。